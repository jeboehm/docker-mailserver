docker-mailserver
=================

Docker Mailserver based on the famous [ISPMail guide](https://workaround.org/ispmail/).

[![Build Status](https://travis-ci.org/jeboehm/docker-mailserver.svg?branch=master)](https://travis-ci.org/jeboehm/docker-mailserver)

Services
--------
| Service                | Address                      |
| ---------------------- | ---------------------------- |
| POP3 (starttls needed) | 127.0.0.1:110                |
| POP3S                  | 127.0.0.1:995                |
| IMAP (starttls needed) | 127.0.0.1:143                |
| IMAPS                  | 127.0.0.1:993                |
| SMTP (starttls needed) | 127.0.0.1:25                 |
| Management Interface   | http://127.0.0.1:81/manager/ |
| Webmail                | http://127.0.0.1:81/webmail/ |

Accounts
--------
| Username          | Password |
| ----------------- | -------- |
| admin@example.com | changeme |

You can create or edit accounts via the management interface (see above).
Passwords can also be edited via webmail.

Spam filters
------------
By default, spam is filtered by Spamassassin with Razor and Pyzor installed additionally.

| Method                                                        | Variable            | Status       |
| ------------------------------------------------------------- | ------------------- | ------------ |
| Spamassassin                                                  | -                   | -            |
| Razor / Pyzor                                                 | -                   | -            |
| Greylisting                                                   | GREYLISTING_ENABLED | experimental |
| Mime Header Checks (bat, com, exe, dll, vbs, docm, doc, dzip) | FILTER_MIME         | experimental |

Experimental filter methods are not covered by integration tests.

Installation
------------
- Clone this repository at first. The command `bin/production.sh` is a wrapper for [docker-compose](https://docs.docker.com/compose/).
  It loads the needed configuration files for using the mailserver in production mode.
- Copy the file `.env.dist` to `.env` and change the variables in it according to your needs.
- Run `bin/production.sh pull` to obtain the images.
- `bin/production.sh up -d` creates and starts the containers.

Volume Management
-----------------
Docker manages the data volumes. The first startup creates three volumes, named data-db, -mail and -tls.
Execute `docker volume inspect <name>` to get its real path in the filesystem.

TLS
---
The TLS certificate is stored in the data-tls volume. Obtain its path by running `docker volume inspect`
and replace the autogenerated certificate with a real one.

Override container configuration
--------------------------------
Container configurations can be overriden by creating the file `docker-compose.override.yml` in the root folder.
The startup script will load it automatically.

If you need further assistance, check the [docker-compose](https://docs.docker.com/compose/) manual.
