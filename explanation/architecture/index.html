<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://jeboehm.github.io/docker-mailserver/explanation/architecture/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Service architecture - docker-mailserver</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Service architecture";
        var mkdocs_page_input_path = "explanation/architecture.md";
        var mkdocs_page_url = "/docker-mailserver/explanation/architecture/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> docker-mailserver
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Welcome</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Tutorial</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../tutorials/getting-started/">Getting Started</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">How-to guides</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../how-to/install-docker/">Install with Docker</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../how-to/install-kubernetes/">Install on Kubernetes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../how-to/upgrade/">Upgrade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../how-to/configure-dns/">Configure DNS</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../how-to/configure-dkim/">Configure DKIM</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../how-to/validate-dns/">Validate DNS (wizard)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../how-to/configure-relayhost/">Configure relay host</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../how-to/configure-reverse-proxy/">Configure reverse proxy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../how-to/configure-tls/">Configure TLS certificates</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../how-to/configure-oauth2/">Configure OAuth2</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../how-to/configure-external-mysql/">Configure external MySQL</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../how-to/configure-roundcube-plugins/">Configure Roundcube plugins</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../how-to/configure-php-sessions/">Configure PHP sessions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../how-to/manage-domains/">Manage domains</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../how-to/manage-users/">Manage users</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../how-to/manage-aliases/">Manage aliases</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../how-to/manage-fetchmail/">Manage fetchmail</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../how-to/ios-macos-profile/">iOS / macOS profile</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Reference</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../reference/environment-variables/">Environment variables</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../reference/ports/">Ports</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../reference/dns-records/">DNS records</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../reference/service-architecture/">Service architecture</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../reference/user-roles/">User roles</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../reference/mailserver-admin-config/">mailserver-admin config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../reference/local-address-extension/">Local address extension</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../reference/upgrade-changelog/">Upgrade changelog</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Administration (web UI)</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../administration/login/">Login</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../administration/dashboard/">Dashboard</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Explanation</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Service architecture</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#why-multiple-services">Why multiple services</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#how-the-services-work-together">How the services work together</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dns-and-email/">DNS and email delivery</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../observability/">Observability</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Recipes</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Docker</a>
    <ul>
                <li class="toctree-l2"><a class="" href="https://github.com/jeboehm/docker-mailserver/tree/main/docs/example-configs/compose/traefik-reverse-proxy">Traefik Reverse Proxy</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Kubernetes</a>
    <ul>
                <li class="toctree-l2"><a class="" href="https://github.com/jeboehm/docker-mailserver/tree/main/docs/example-configs/kustomize/external-db-and-https-ingress">External Database and HTTPS Ingress</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Development</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../development/development/">Development guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../development/mailserver-admin/">mailserver-admin development</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="https://github.com/jeboehm/docker-mailserver/issues">Issues</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">docker-mailserver</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Explanation</li>
      <li class="breadcrumb-item active">Service architecture</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/jeboehm/docker-mailserver/blob/main/docs/explanation/architecture.md">Edit on jeboehm/docker-mailserver</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="about-the-service-architecture">About the Service Architecture</h1>
<p>docker-mailserver is built from several services that handle different parts of mail delivery and management. Understanding how they fit together helps when configuring, troubleshooting, or extending the system.</p>
<h2 id="why-multiple-services">Why multiple services</h2>
<p>Email delivery involves distinct tasks: accepting and relaying mail (MTA), storing and serving mailboxes (MDA), filtering spam (filter), and providing a web UI (web). Splitting these into separate services lets each use the right technology (Postfix, Dovecot, Rspamd, PHP) and scale or replace components independently.</p>
<h2 id="how-the-services-work-together">How the services work together</h2>
<ul>
<li>
<p><strong>MTA (Postfix)</strong> receives mail on port 25 and accepts submissions on port 587. It looks up recipients in the database, applies relay and policy, and hands mail to the filter for scanning. After filtering, it delivers to the MDA via LMTP or stores in the queue for later delivery.</p>
</li>
<li>
<p><strong>MDA (Dovecot)</strong> stores mail in maildirs and serves it over IMAP and POP3. It authenticates users against the database and enforces quotas. The web interface uses Dovecot for authentication and mailbox access; the filter may use Dovecot for scanning.</p>
</li>
<li>
<p><strong>Filter (Rspamd)</strong> scans messages for spam and viruses, applies DKIM signing, and can learn from user actions (e.g. moving mail to junk). It runs as a milter so the MTA can pass messages through it before delivery.</p>
</li>
<li>
<p><strong>Web</strong> runs the admin UI (mailserver-admin) and Roundcube webmail. It talks to the database for users, domains, aliases, and DKIM, and to Dovecot for authentication and mailbox operations. Observability features pull data from Rspamd and Dovecot (e.g. Doveadm HTTP API).</p>
</li>
<li>
<p><strong>Database (MySQL)</strong> holds users, domains, aliases, DKIM config, and application data. All services that need this data connect to the same database.</p>
</li>
<li>
<p><strong>Redis</strong> is used for sessions and caching so the web service can run across multiple instances without losing session state.</p>
</li>
<li>
<p><strong>Unbound</strong> (when used) provides DNS resolution for the filter so RBL and other DNS-based checks work correctly.</p>
</li>
<li>
<p><strong>SSL</strong> (optional) generates and manages internal TLS certificates. In production you typically replace these with certificates from a CA (e.g. Letâ€™s Encrypt).</p>
</li>
<li>
<p><strong>Fetchmail</strong> (optional) periodically connects to external mail servers (POP3/IMAP) and delivers retrieved mail into local mailboxes.</p>
</li>
</ul>
<p>For a concise list of services and volumes, see <a href="../../reference/service-architecture/">Service architecture reference</a>.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../administration/dashboard/" class="btn btn-neutral float-left" title="Dashboard"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../dns-and-email/" class="btn btn-neutral float-right" title="DNS and email delivery">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/jeboehm/docker-mailserver" class="fa fa-code-fork" style="color: #fcfcfc"> jeboehm/docker-mailserver</a>
        </span>
    
    
      <span><a href="../../administration/dashboard/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../dns-and-email/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
